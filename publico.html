<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Tempos ao Vivo</title>
  <style>
    body{font-family:'Segoe UI';padding:20px;background:#f9f9f9;}
    .grade{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;}
    .cartao{background:#fff;padding:20px;border-radius:12px;text-align:center;}
    .nome{font-size:1.3rem;font-weight:600;margin-bottom:10px;}
    .tempo{font-size:2.5rem;color:#007BFF;font-weight:bold;}
  </style>
</head>
<body>
  <div class="grade" id="container"></div>

  <script type="module">
    import { db } from './firebase-config.js';
    import { ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    const container=document.getElementById('container');
    let tempos={}, nomes={};

    function formatarTempo(seg){const m=Math.floor(seg/60).toString().padStart(2,'0');const s=(seg%60).toString().padStart(2,'0');return `${m}:${s}`;}

    function atualizarEcran(){
      container.innerHTML='';
      Object.entries(tempos).forEach(([nome,dados])=>{
        const nomeExibir=nomes[nome]||nome;
        const t=dados?.tempoRestante||0;
        const div=document.createElement('div');
        div.className='cartao';
        div.innerHTML=`<div class="nome">${nomeExibir}</div><div class="tempo">${formatarTempo(t)}</div>`;
        container.appendChild(div);
      });
    }

    onValue(ref(db,'tempos'),snapshot=>{tempos=snapshot.val()||{};atualizarEcran();});
    onValue(ref(db,'nomes'),snapshot=>{nomes=snapshot.val()||{};atualizarEcran();});
  </script>
</body>
</html>
